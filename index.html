<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CRUSH AX MODS ‚Äì Admin Panel</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=JetBrains+Mono:wght@600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
:root{
--bg:#050508;--card:rgba(20,20,25,.6);--nav:rgba(25,25,35,.8);
--accent:#00e5ff;--text:#fff;--muted:#94a3b8;
--border:rgba(255,255,255,.08);
--green:#00ff9d;--red:#ff0055;
--glass:blur(24px) saturate(180%);
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{
margin:0;font-family:Inter,sans-serif;
background:var(--bg);color:var(--text);
padding-bottom:110px
}
header{
position:sticky;top:0;z-index:50;
display:flex;justify-content:space-between;align-items:center;
padding:15px 20px;
background:rgba(0,0,0,.3);
backdrop-filter:var(--glass);
border-bottom:1px solid var(--border)
}
.brand{font-weight:800;display:flex;gap:10px;align-items:center}
.icon-btn{
width:38px;height:38px;border-radius:12px;
display:flex;align-items:center;justify-content:center;
background:rgba(255,255,255,.05);
border:1px solid var(--border);
color:var(--muted);cursor:pointer
}
.icon-btn.danger{border-color:var(--red);color:var(--red)}
.container{max-width:600px;margin:auto;padding:20px}
.card{
background:var(--card);border:1px solid var(--border);
border-radius:20px;padding:18px;margin-bottom:12px
}
.mono{font-family:"JetBrains Mono",monospace}
.btn{
padding:12px;border-radius:14px;border:none;
font-weight:800;cursor:pointer
}
.btn-main{background:var(--accent);color:#000}
.btn-danger{
background:rgba(255,0,85,.15);
border:1px solid var(--red);color:var(--red)
}
.modal{
position:fixed;inset:0;background:rgba(0,0,0,.85);
display:flex;align-items:center;justify-content:center;
opacity:0;pointer-events:none;transition:.3s;z-index:200
}
.modal.open{opacity:1;pointer-events:auto}
.modal-box{
background:#111;border-radius:20px;
padding:25px;width:90%;max-width:320px;
border:1px solid var(--border)
}
input{
width:100%;padding:12px;border-radius:12px;
border:1px solid var(--border);
background:#000;color:#fff;margin-top:10px
}
.toast{
position:fixed;top:20px;left:50%;
transform:translateX(-50%) translateY(-120px);
background:#111;border:1px solid var(--accent);
padding:12px 24px;border-radius:50px;
transition:.4s;z-index:300
}
.toast.show{transform:translateX(-50%) translateY(0)}
</style>
</head>

<body>

<header>
  <div class="brand"><i class="fas fa-cube"></i> CRUSH AX MODS</div>

  <!-- üî• SAME PLACE AS YOUR CIRCLE -->
  <div style="display:flex;gap:10px">
    <div class="icon-btn danger" title="Delete All" onclick="openDeleteModal()">
      <i class="fas fa-bomb"></i>
    </div>
    <div class="icon-btn" onclick="appInit(true)">
      <i class="fas fa-sync-alt"></i>
    </div>
  </div>
</header>

<div class="container">

  <!-- DASHBOARD -->
  <div class="card">
    <b>Dashboard</b><br>
    <span style="color:var(--muted);font-size:.8rem">
      Keys ‚Ä¢ Devices ‚Ä¢ Banned
    </span>
  </div>

  <!-- KEYS -->
  <div class="card">
    <b>üîë Valid Keys</b>
    <div id="keysList" class="mono" style="margin-top:10px;font-size:.85rem"></div>
  </div>

  <!-- DEVICES -->
  <div class="card">
    <b>üì± Devices</b>
    <div id="deviceList" class="mono" style="margin-top:10px;font-size:.85rem"></div>
  </div>

</div>

<!-- DELETE MODAL -->
<div class="modal" id="deleteModal">
  <div class="modal-box">
    <h3 style="color:var(--red)">‚ö†Ô∏è Delete All</h3>
    <p style="font-size:.8rem;color:var(--muted)">
      Enter Admin PIN to delete all keys & devices
    </p>
    <input type="password" id="deletePin" placeholder="Enter PIN">
    <button class="btn btn-danger" style="margin-top:15px;width:100%" onclick="confirmDelete()">
      CONFIRM DELETE
    </button>
  </div>
</div>

<div class="toast" id="toast">Done</div>

<script>
const ADMIN_PIN="7860";
let dbUrl=localStorage.getItem("gateway_db_url")||"";
let dbData={ValidKeys:{},ActivatedUsers:{},BannedDevices:{}};

function toast(msg){
 const t=document.getElementById("toast");
 t.innerText=msg;
 t.classList.add("show");
 setTimeout(()=>t.classList.remove("show"),2000)
}
function sanitize(u){return u.endsWith("/")?u+".json":u+"/.json"}

function appInit(){
 if(!dbUrl)return;
 fetch(sanitize(dbUrl))
 .then(r=>r.json())
 .then(d=>{
   if(d) dbData=d;
   render();
 })
}
function render(){
 const k=document.getElementById("keysList");
 const d=document.getElementById("deviceList");

 k.innerHTML=Object.keys(dbData.ValidKeys||{}).join("<br>")||"No Keys";
 d.innerHTML=[
   ...Object.keys(dbData.ActivatedUsers||{}),
   ...Object.keys(dbData.BannedDevices||{})
 ].join("<br>")||"No Devices";
}

function openDeleteModal(){
 document.getElementById("deletePin").value="";
 document.getElementById("deleteModal").classList.add("open");
}

function confirmDelete(){
 const p=document.getElementById("deletePin").value;
 if(p!==ADMIN_PIN){toast("‚ùå Wrong PIN");return}
 if(!confirm("FINAL WARNING!\nALL KEYS & DEVICES WILL BE DELETED"))return;

 dbData.ValidKeys={};
 dbData.ActivatedUsers={};
 dbData.BannedDevices={};

 fetch(sanitize(dbUrl),{
  method:"PUT",
  body:JSON.stringify(dbData)
 }).then(()=>{
   toast("üî• ALL DATA DELETED");
   document.getElementById("deleteModal").classList.remove("open");
   render();
 })
}

appInit();
</script>

</body>
</html>